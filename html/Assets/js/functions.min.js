(()=>{var e=window["@influxdata/influxdb-client"];let t=new(e=e.InfluxDB)({url:"https://us-east-1-1.aws.cloud2.influxdata.com",token:"cZmC8AnYL7nJG0dZ7h9KPhA6GZJTVumqgESPxHOSA_p_wamyUZOrpYgYgMTzeE7-KGrtBJz2ryNaz-cHday6Vw=="}).getQueryApi("329da431464ce2c5"),a=[],n=[],o,r,i=!1;function l(){navigator.onLine?t.queryRows(`
            from(bucket: "project_ITA")
                |> range(start: -1h) // Última hora de datos
                |> filter(fn: (r) => r._measurement == "humidity") // Filtrar por medición
                |> filter(fn: (r) => r._field == "humidity") // Filtrar por campo
                |> sort(columns: ["_time"], desc: false) // Ordenar cronológicamente
        `,{next(e,t){t=t.toObject(e),e=new Date(t._time).toLocaleTimeString(),t=parseFloat(t._value);a.includes(e)||(a.push(e),n.push(t),20<a.length&&(a.shift(),n.shift()))},error(e){console.error("Error en la consulta:",e)},complete(){var e;console.log("Datos actualizados:",n),e=document.getElementById("mqttChart").getContext("2d"),o&&o.destroy(),o=new Chart(e,{type:"line",data:{labels:a,datasets:[{label:"Humedad (%)",data:n,borderColor:"blue",backgroundColor:"rgba(4, 4, 238, 0.9)",borderWidth:2,pointRadius:3}]},options:{responsive:!0,scales:{x:{title:{display:!0,text:"Hora"}},y:{title:{display:!0,text:"Humedad (%)"},suggestedMin:0,suggestedMax:100}}}})}}):(console.warn("No hay conexión a Internet. Pausando la consulta."),i&&(clearInterval(r),i=!1,console.warn("Actualización detenida.")))}function s(){i||(i=!0,l(),r=setInterval(l,5e3))}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mqttChart")?s():console.warn("El elemento <canvas> no está presente. No iniciando consulta.")}),window.addEventListener("online",s),e=L.map("map").setView([41.65606,-.87734],13),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(e)})();
//# sourceMappingURL=functions.min.js.map